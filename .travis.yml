sudo: required
dist: trusty
language: node_js
git:
  depth: 10
node_js:
- 4
- 8
before_install:
- export PATH=$(python -c 'from sys import argv;from collections import OrderedDict
  as od;print(":".join(od((p,None) for p in argv[1].split(":") if p.startswith("/")).keys()))'
  "$PATH")
- rvm install 2.2
- rvm use 2.2 --fuzzy
- gem install sass
install:
- bundle install --deployment --jobs=1
- cp grunt/npm-shrinkwrap.json ./
- npm install
before_script:
  - chmod +x ./deploy.sh
after_success:
  - npm run prep-release
  - ./deploy.sh
cache:
  directories:
  - node_modules
  - vendor/bundle
env:
  global:
  - NPM_CONFIG_PROGRESS="false"
  - SAUCE_USERNAME="bootstrap"
  - secure: $GH_TOKEN
matrix:
  fast_finish: true
#notifications:
#  slack: askanything:tSVB70CS7mqvrtFfQ8H0s12l
deploy:
  provider: pages
  skip_cleanup: true
  github_token: $GH_TOKEN
  on:
    branch: gh-pages
